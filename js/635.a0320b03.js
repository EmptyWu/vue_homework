"use strict";(self["webpackChunkhomework7"]=self["webpackChunkhomework7"]||[]).push([[635],{2464:function(t,e,a){a.d(e,{Z:function(){return k}});var l=a(3396),o=a(7139);const i={class:"modal fade",id:"delModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},s={class:"modal-dialog",role:"document"},d={class:"modal-content border-0"},n={class:"modal-header bg-danger text-white"},r={class:"modal-title"},c=(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),u={class:"modal-body"},p=(0,l.Uk)(" 是否刪除 "),m={class:"text-danger"},h=(0,l.Uk)(" (刪除後將無法恢復)。 "),b={class:"modal-footer"},g=(0,l._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消 ",-1);function _(t,e,a,_,f,v){return(0,l.wg)(),(0,l.iD)("div",i,[(0,l._)("div",s,[(0,l._)("div",d,[(0,l._)("div",n,[(0,l._)("h5",r,[(0,l._)("span",null,"刪除 "+(0,o.zw)(a.item.title??a.item.id),1)]),c]),(0,l._)("div",u,[p,(0,l._)("strong",m,(0,o.zw)(a.item.title??a.item.id),1),h]),(0,l._)("div",b,[g,(0,l._)("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=e=>t.$emit("del-item"))},"確認刪除 ")])])])],512)}var f=a(7972),v=a.n(f),w={props:{item:{}},data(){return{modal:""}},emits:["del-item"],methods:{openModal(){this.modal.show()},hideModal(){this.modal.hide()}},mounted(){this.modal=new(v())(this.$refs.modal)}},y=a(89);const D=(0,y.Z)(w,[["render",_]]);var k=D},7385:function(t,e,a){a.d(e,{Z:function(){return _}});var l=a(3396),o=a(7139),i=a(9242);const s={"aria-label":"Page navigation example"},d={class:"pagination justify-content-center"},n=(0,l._)("span",{"aria-hidden":"true"},"«",-1),r=[n],c=["onClick"],u=(0,l._)("span",{"aria-hidden":"true"},"»",-1),p=[u];function m(t,e,a,n,u,m){return(0,l.wg)(),(0,l.iD)("nav",s,[(0,l._)("ul",d,[(0,l._)("li",{class:(0,o.C_)(["page-item",{disabled:!a.pages.has_pre}])},[(0,l._)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:e[0]||(e[0]=(0,i.iM)((e=>t.$emit("emitPages",a.pages.current_page-1)),["prevent"]))},r)],2),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.pages.total_pages,((e,s)=>((0,l.wg)(),(0,l.iD)("li",{class:(0,o.C_)(["page-item",{active:e===a.pages.current_page}]),key:s},[(0,l._)("a",{class:"page-link",href:"#",onClick:(0,i.iM)((a=>t.$emit("emitPages",e)),["prevent"])},(0,o.zw)(e),9,c)],2)))),128)),(0,l._)("li",{class:(0,o.C_)(["page-item",{disabled:!a.pages.has_next}])},[(0,l._)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:e[1]||(e[1]=(0,i.iM)((e=>t.$emit("emitPages",a.pages.current_page+1)),["prevent"]))},p)],2)])])}var h={props:["pages"]},b=a(89);const g=(0,b.Z)(h,[["render",m]]);var _=g},6635:function(t,e,a){a.r(e),a.d(e,{default:function(){return yt}});var l=a(3396),o=a(7139);const i={class:"container-fluid"},s=(0,l._)("h1",null,"後臺產品列表",-1),d={class:"text-end mt-4"},n={class:"table mt-4"},r=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",{width:"120"}," 分類 "),(0,l._)("th",null,"產品名稱"),(0,l._)("th",{width:"120"}," 原價 "),(0,l._)("th",{width:"120"}," 售價 "),(0,l._)("th",{width:"100"}," 是否啟用 "),(0,l._)("th",{width:"120"}," 編輯 ")])],-1),c={key:0,class:"text-success"},u={key:1},p={class:"btn-group"},m=["onClick"],h=["onClick"];function b(t,e,a,b,g,_){const f=(0,l.up)("LoadingComponent"),v=(0,l.up)("PaginationModal"),w=(0,l.up)("DelModal"),y=(0,l.up)("ProductModalVue");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(f,{active:g.isLoading},null,8,["active"]),(0,l._)("div",i,[s,(0,l._)("div",d,[(0,l._)("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=t=>_.openTarget("new"))}," 建立新的產品 ")]),(0,l._)("table",n,[r,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(g.products,(t=>((0,l.wg)(),(0,l.iD)("tr",{key:t.id},[(0,l._)("td",null,(0,o.zw)(t.category),1),(0,l._)("td",null,(0,o.zw)(t.title),1),(0,l._)("td",null,(0,o.zw)(t.origin_price),1),(0,l._)("td",null,(0,o.zw)(t.price),1),(0,l._)("td",null,[t.is_enabled?((0,l.wg)(),(0,l.iD)("span",c,"啟用")):((0,l.wg)(),(0,l.iD)("span",u,"未啟用"))]),(0,l._)("td",null,[(0,l._)("div",p,[(0,l._)("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:e=>_.openTarget("edit",t)}," 編輯 ",8,m),(0,l._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:e=>_.openTarget("del",t)}," 刪除 ",8,h)])])])))),128))])]),(0,l.Wm)(v,{pages:g.pagination,onEmitPages:_.getData},null,8,["pages","onEmitPages"])]),(0,l.Wm)(w,{ref:"delModal",item:g.tmpProduct,onDelItem:_.deleteItem},null,8,["item","onDelItem"]),(0,l.Wm)(y,{ref:"productModal","tmp-product":g.tmpProduct,"is-new":g.isNew,onGetData:_.getData},null,8,["tmp-product","is-new","onGetData"])],64)}var g=a(2464),_=a(9242);const f={id:"productModal",ref:"productModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},v={class:"modal-dialog modal-xl"},w={class:"modal-content border-0"},y={class:"modal-header bg-dark text-white"},D={id:"productModalLabel",class:"modal-title"},k={class:"modal-body"},M={class:"row"},P={class:"col-sm-4"},U=(0,l._)("h3",null,"主要圖片",-1),C={class:"mb-3"},x={for:"imageUrl",class:"form-label"},$=(0,l.Uk)("輸入圖片網址 "),V=["src"],L=(0,l._)("h3",null,"其他圖片",-1),I={class:"mb-2"},z={class:"mb-3"},Z={for:"imageUrl",class:"form-label"},N=(0,l.Uk)("輸入圖片網址 "),H=["onUpdate:modelValue"],S=["src"],Y={key:0},T=["onClick"],W={key:1},K=["onClick"],A=(0,l._)("div",{class:"mb-2"},[(0,l._)("div",{class:"mb-3"},[(0,l._)("input",{type:"file",id:"file",class:"form-control",placeholder:"請輸入圖片連結"})])],-1),E={class:"col-sm-8"},G={class:"mb-3"},j=(0,l._)("label",{for:"title",class:"form-label"},"標題",-1),q={class:"row"},F={class:"mb-3 col-md-6"},B=(0,l._)("label",{for:"category",class:"form-label"},"分類",-1),J={class:"mb-3 col-md-6"},O=(0,l._)("label",{for:"price",class:"form-label"},"單位",-1),Q={class:"row"},R={class:"mb-3 col-md-6"},X=(0,l._)("label",{for:"origin_price",class:"form-label"},"原價",-1),tt={class:"mb-3 col-md-6"},et=(0,l._)("label",{for:"price",class:"form-label"},"售價",-1),at=(0,l._)("hr",null,null,-1),lt={class:"mb-3"},ot=(0,l._)("label",{for:"description",class:"form-label"},"產品描述",-1),it={class:"mb-3"},st=(0,l._)("label",{for:"content",class:"form-label"},"說明內容",-1),dt={class:"mb-3"},nt={class:"form-check"},rt=(0,l._)("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),ct={class:"modal-footer"};function ut(t,e,a,i,s,d){return(0,l.wg)(),(0,l.iD)("div",f,[(0,l._)("div",v,[(0,l._)("div",w,[(0,l._)("div",y,[(0,l._)("h5",D,[(0,l._)("span",null,(0,o.zw)(a.isNew?"新增":"修改")+"產品",1)]),(0,l._)("button",{type:"button",class:"btn-close",onClick:e[0]||(e[0]=(...t)=>d.cancelProduct&&d.cancelProduct(...t)),"aria-label":"Close"})]),(0,l._)("div",k,[(0,l._)("div",M,[(0,l._)("div",P,[U,(0,l._)("div",C,[(0,l._)("label",x,[$,(0,l._)("input",{type:"file",id:"mainImage",class:"form-control",onChange:e[1]||(e[1]=t=>d.uploadImage("main")),placeholder:"請輸入圖片連結"},null,32)]),(0,l._)("img",{class:"img-fluid",src:this.tmpProduct.imageUrl,alt:""},null,8,V)]),L,((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.tmpProduct.imagesUrl,((t,e)=>((0,l.wg)(),(0,l.iD)(l.HY,{key:e},[(0,l._)("div",I,[(0,l._)("div",z,[(0,l._)("label",Z,[N,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control","onUpdate:modelValue":t=>d.productData.imagesUrl[e]=t,placeholder:"請輸入圖片連結"},null,8,H),[[_.nr,d.productData.imagesUrl[e]]])])]),(0,l._)("img",{class:"img-fluid",src:t,alt:""},null,8,S)]),""===d.productData.imagesUrl[e]?((0,l.wg)(),(0,l.iD)("div",Y,[(0,l._)("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:t=>d.productData.imagesUrl.splice(e,1)}," 取消圖片 ",8,T)])):((0,l.wg)(),(0,l.iD)("div",W,[(0,l._)("button",{class:"btn btn-outline-danger btn-sm d-block w-100",onClick:t=>d.productData.imagesUrl.splice(e,1)}," 刪除圖片 ",8,K)]))],64)))),128)),A,(0,l._)("div",null,[(0,l._)("button",{class:"btn btn-outline-primary btn-sm d-block w-100",type:"button",onClick:e[2]||(e[2]=t=>d.uploadImage("other"))}," 新增圖片 ")])]),(0,l._)("div",E,[(0,l._)("div",G,[j,(0,l.wy)((0,l._)("input",{id:"title",type:"text",class:"form-control","onUpdate:modelValue":e[3]||(e[3]=t=>d.productData.title=t),placeholder:"請輸入標題"},null,512),[[_.nr,d.productData.title]])]),(0,l._)("div",q,[(0,l._)("div",F,[B,(0,l.wy)((0,l._)("input",{id:"category",type:"text",class:"form-control","onUpdate:modelValue":e[4]||(e[4]=t=>d.productData.category=t),placeholder:"請輸入分類"},null,512),[[_.nr,d.productData.category]])]),(0,l._)("div",J,[O,(0,l.wy)((0,l._)("input",{id:"unit",type:"text",class:"form-control","onUpdate:modelValue":e[5]||(e[5]=t=>d.productData.unit=t),placeholder:"請輸入單位"},null,512),[[_.nr,d.productData.unit]])])]),(0,l._)("div",Q,[(0,l._)("div",R,[X,(0,l.wy)((0,l._)("input",{id:"origin_price",type:"number",min:"0","onUpdate:modelValue":e[6]||(e[6]=t=>d.productData.origin_price=t),class:"form-control",placeholder:"請輸入原價"},null,512),[[_.nr,d.productData.origin_price,void 0,{number:!0}]])]),(0,l._)("div",tt,[et,(0,l.wy)((0,l._)("input",{id:"price",type:"number",min:"0",class:"form-control","onUpdate:modelValue":e[7]||(e[7]=t=>d.productData.price=t),placeholder:"請輸入售價"},null,512),[[_.nr,d.productData.price,void 0,{number:!0}]])])]),at,(0,l._)("div",lt,[ot,(0,l.wy)((0,l._)("textarea",{id:"description",type:"text",class:"form-control","onUpdate:modelValue":e[8]||(e[8]=t=>d.productData.description=t),placeholder:"請輸入產品描述"},"\n                ",512),[[_.nr,d.productData.description]])]),(0,l._)("div",it,[st,(0,l.wy)((0,l._)("textarea",{id:"description",type:"text",class:"form-control","onUpdate:modelValue":e[9]||(e[9]=t=>d.productData.content=t),placeholder:"請輸入說明內容"},"\n                ",512),[[_.nr,d.productData.content]])]),(0,l._)("div",dt,[(0,l._)("div",nt,[rt,(0,l.wy)((0,l._)("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","onUpdate:modelValue":e[10]||(e[10]=t=>d.productData.is_enabled=t),"true-value":1,"false-value":0},null,512),[[_.e8,d.productData.is_enabled]])])])])])]),(0,l._)("div",ct,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary",onClick:e[11]||(e[11]=(...t)=>d.cancelProduct&&d.cancelProduct(...t))}," 取消 "),(0,l._)("button",{type:"button",class:"btn btn-primary",onClick:e[12]||(e[12]=(...t)=>d.updateProduct&&d.updateProduct(...t))}," 確認 ")])])])],512)}var pt=a(7972),mt=a.n(pt),ht={props:["tmpProduct","isNew"],data(){return{imgUrl:"",productModal:""}},methods:{updateProduct(){let t="https://vue3-course-api.hexschool.io/v2/api/emptywu/admin/product",e="post";this.productData?.id&&(t=`https://vue3-course-api.hexschool.io/v2/api/emptywu/admin/product/${this.tmpProduct.id}`,e="put"),this.$http[e](t,{data:this.tmpProduct}).then((t=>{this.$httpMessageState(t,"更新產品"),this.closeModal(),this.$emit("get-data")})).catch((t=>{this.$httpMessageState(t.response,"錯誤訊息")}))},cancelProduct(){this.closeModal(),this.imgUrl=""},uploadImage(t){const e="main"===t?"mainImage":"file",a=document.querySelector(`#${e}`);if(a.files.length>0){const e=a.files[0],l=new FormData;l.append("file-to-upload",e),this.$http.post("https://vue3-course-api.hexschool.io/v2/api/emptywu/admin/upload",l).then((e=>{e.data.success&&("main"===t?this.productData.imageUrl=e.data.imageUrl:(Array.isArray(this.tmpProduct.imagesUrl)||(this.productData.imagesUrl=[]),this.productData.imagesUrl.push(e.data.imageUrl)),a.value=null)}))}},openModal(){this.productModal.show()},closeModal(){this.productModal.hide()}},computed:{productData:{get(){const t=this.tmpProduct;return t},set(t){console.log(t)}}},mounted(){this.productModal=new(mt())(this.$refs.productModal,{keyboard:!1})}},bt=a(89);const gt=(0,bt.Z)(ht,[["render",ut]]);var _t=gt,ft=a(7385),vt={name:"ProductsView",data(){return{isNew:!0,isLoading:!1,pagination:{},products:[],tmpProduct:{imagesUrl:[]}}},methods:{openTarget(t,e){switch(this.tmpProduct={imagesUrl:[]},t){case"new":this.$refs.productModal.openModal(),this.isNew=!0;break;case"edit":this.tmpProduct={...e},this.$refs.productModal.openModal(),this.isNew=!1;break;case"del":this.tmpProduct={...e},this.$refs.delModal.openModal();break;default:break}},getData(t=1){this.isLoading=!0,this.$http.get(`https://vue3-course-api.hexschool.io/v2/api/emptywu/admin/products?page=${t}`).then((t=>{this.products=t.data.products,this.pagination=t.data.pagination,this.isLoading=!1})).catch((t=>{this.isLoading=!1,this.$httpMessageState(t.response,"錯誤訊息")}))},deleteItem(){this.isLoading=!0,this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/emptywu/admin/product/${this.tmpProduct.id}`).then((()=>{this.$refs.delModal.hideModal(),this.getData(),this.isLoading=!1})).catch((t=>{this.isLoading=!1,this.$httpMessageState(t.response,"錯誤訊息")}))}},components:{DelModal:g.Z,ProductModalVue:_t,PaginationModal:ft.Z},mounted(){this.getData(1)}};const wt=(0,bt.Z)(vt,[["render",b]]);var yt=wt}}]);
//# sourceMappingURL=635.a0320b03.js.map