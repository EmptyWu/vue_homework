"use strict";(self["webpackChunkhomework7"]=self["webpackChunkhomework7"]||[]).push([[921],{7921:function(t,o,d){d.r(o),d.d(o,{default:function(){return J}});var s=d(3396),a=d(7139);const e={class:"container"},l=(0,s._)("h2",null,"產品列表",-1),i={class:"row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-3"},c={class:"card h-100"},r=["src"],n={class:"card-body"},u={class:"card-title"},p={class:"card-text"},h={class:"card-footer text-muted text-center"},g=["disabled","onClick"],m=(0,s.Uk)(" 查看更多 "),w=["onClick"],b=(0,s.Uk)(" 加入購物車");function v(t,o,d,v,_,y){const k=(0,s.up)("font-awesome-icon"),M=(0,s.up)("UserProductModal");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",e,[l,(0,s._)("div",i,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(_.products,(t=>((0,s.wg)(),(0,s.iD)("div",{class:"col",key:t.id},[(0,s._)("div",c,[(0,s._)("img",{src:t.imageUrl,class:"card-img-top obj-cover obj-position-bottom",style:{height:"200px"},alt:"..."},null,8,r),(0,s._)("div",n,[(0,s._)("h5",u,(0,a.zw)(t.title),1),(0,s._)("p",p,(0,a.zw)(t.description),1)]),(0,s._)("div",h,[(0,s._)("button",{type:"button",class:"btn btn-primary",disabled:_.loadingFlag===t.id,onClick:o=>y.showMore(t.id)},[_.loadingFlag===t.id?((0,s.wg)(),(0,s.j4)(k,{key:0,icon:"spinner",pulse:""})):(0,s.kq)("",!0),m],8,g),(0,s._)("button",{class:"btn btn-danger ms-3",onClick:o=>y.updateCart("add",t.id)},[_.loadingFlag===t.id?((0,s.wg)(),(0,s.j4)(k,{key:0,icon:"spinner",pulse:""})):(0,s.kq)("",!0),b],8,w)])])])))),128))])]),(0,s.Wm)(M,{ref:"userProductModal",id:_.productId,onLoadingFlag:y.closeLoadingFlag,onAddCart:y.updateCart},null,8,["id","onLoadingFlag","onAddCart"])],64)}var _=d(9242);const y={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},k={class:"modal-dialog modal-xl",role:"document"},M={class:"modal-content border-0"},f={class:"modal-header bg-dark text-white"},$={class:"modal-title",id:"exampleModalLabel"},x=(0,s._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),C={class:"modal-body"},F={class:"row"},z={class:"col-sm-6"},L=["src"],P={class:"col-sm-6"},q={class:"badge bg-primary rounded-pill"},D={key:0,class:"h5"},U={key:1},j={class:"h6"},S={class:"h5"},H={class:"input-group"},I=["value","selected"];function Y(t,o,d,e,l,i){return(0,s.wg)(),(0,s.iD)("div",y,[(0,s._)("div",k,[(0,s._)("div",M,[(0,s._)("div",f,[(0,s._)("h5",$,[(0,s._)("span",null,(0,a.zw)(l.product.title),1)]),x]),(0,s._)("div",C,[(0,s._)("div",F,[(0,s._)("div",z,[(0,s._)("img",{class:"img-fluid",src:l.product.imageUrl,alt:""},null,8,L)]),(0,s._)("div",P,[(0,s._)("span",q,(0,a.zw)(l.product.category),1),(0,s._)("p",null,"商品描述："+(0,a.zw)(l.product.description),1),(0,s._)("p",null,"商品內容："+(0,a.zw)(l.product.content),1),l.product.price===l.product.origin_price?((0,s.wg)(),(0,s.iD)("div",D,(0,a.zw)(l.product.price)+" 元 ",1)):((0,s.wg)(),(0,s.iD)("div",U,[(0,s._)("del",j,"原價 "+(0,a.zw)(l.product.origin_price)+" 元",1),(0,s._)("div",S,"現在只要 "+(0,a.zw)(l.product.price)+" 元",1)])),(0,s._)("div",null,[(0,s._)("div",H,[(0,s.wy)((0,s._)("select",{"onUpdate:modelValue":o[0]||(o[0]=t=>l.qty=t),class:"form-select"},[((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)(20,(t=>(0,s._)("option",{key:t+d.id,value:t,selected:1===t},(0,a.zw)(t),9,I))),64))],512),[[_.bM,l.qty,void 0,{number:!0}]]),(0,s._)("button",{type:"button",class:"btn btn-primary",onClick:o[1]||(o[1]=t=>this.$emit("add-cart","add",l.product.id,l.qty))}," 加入購物車 ")])])])])])])])],512)}var A=d(7972),K=d.n(A),Z={props:{id:String},data(){return{product:{},qty:1,productModal:""}},watch:{id(){this.getProduct()}},methods:{getProduct(){this.qty=1,this.$http.get(`https://vue3-course-api.hexschool.io/v2/api/emptywu/product/${this.id}`).then((t=>{this.product=t.data.product,this.$emit("loadingFlag",""),this.$emit("isLoading")})).catch((t=>{this.$httpMessageState(t.response,"錯誤訊息")}))},openModal(){this.productModal.show()},closeModal(){this.productModal.hide()}},mounted(){this.productModal=new(K())(this.$refs.modal,{keyboard:!1})}},V=d(89);const W=(0,V.Z)(Z,[["render",Y]]);var B=W,E={data(){return{products:[],loadingFlag:"",productId:""}},methods:{getProducts(){this.$http("https://vue3-course-api.hexschool.io/v2/api/emptywu/products/all").then((t=>{this.products=t.data.products}))},showMore(t){this.closeLoadingFlag(t),this.productId=t,this.$refs.userProductModal.openModal()},closeLoadingFlag(t){this.loadingFlag=t},updateCart(t,o,d=1){let s="https://vue3-course-api.hexschool.io/v2/api/emptywu/cart",a="post";"update"===t&&(s=`https://vue3-course-api.hexschool.io/v2/api/emptywu/cart/${o}`,a="put"),this.closeLoadingFlag(o);const e={product_id:o,qty:d};this.$http[a](s,{data:e}).then((o=>{o.data.success&&(this.closeLoadingFlag(""),this.$refs.userProductModal.closeModal(),this.$httpMessageState(o,("update"===t?"更新":"新增")+"購物車"))})).catch((t=>{this.$httpMessageState(t.response,"錯誤訊息")}))}},components:{UserProductModal:B},mounted(){this.getProducts()}};const G=(0,V.Z)(E,[["render",v]]);var J=G}}]);
//# sourceMappingURL=921.07d000d6.js.map